node('built-in') {
 
  stage('clone from repository') {
    checkout scm
  }
  
  stage('Build stage') {
        withMaven {
          sh 'mvn clean install -DskipTests'
        }
  }
  
  stage('Test stage') {
     if (env.BRANCH_NAME == 'master') {
       withMaven {
        sh 'mvn test'
       }
     }
  }
  
  stage('Clean Workspace') {
      cleanWs()
  }
  
}
